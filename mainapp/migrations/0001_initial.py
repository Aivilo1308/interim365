# Generated by Django 4.2.21 on 2025-06-26 23:46

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Competence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('categorie', models.CharField(blank=True, max_length=50)),
                ('kelio_skill_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_skill_abbreviation', models.CharField(blank=True, max_length=10)),
                ('type_competence', models.CharField(choices=[('TECHNIQUE', 'Technique'), ('TRANSVERSE', 'Transverse'), ('COMPORTEMENTALE', 'Comportementale'), ('LINGUISTIQUE', 'Linguistique'), ('LOGICIEL', 'Logiciel')], default='TECHNIQUE', max_length=20)),
                ('obsolete', models.BooleanField(default=False)),
            ],
            options={
                'verbose_name': 'Compétence',
                'verbose_name_plural': 'Compétences',
                'ordering': ['categorie', 'nom'],
            },
        ),
        migrations.CreateModel(
            name='ConfigurationApiKelio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('url_base', models.URLField(help_text='URL de base du service SOAP Kelio')),
                ('username', models.CharField(max_length=100)),
                ('password', models.CharField(help_text='Mot de passe (sera crypté automatiquement)', max_length=500)),
                ('timeout_seconds', models.IntegerField(default=30, validators=[django.core.validators.MinValueValidator(5), django.core.validators.MaxValueValidator(300)])),
                ('service_employees', models.BooleanField(default=True)),
                ('service_absences', models.BooleanField(default=True)),
                ('service_formations', models.BooleanField(default=False)),
                ('service_competences', models.BooleanField(default=False)),
                ('cache_duree_defaut_minutes', models.IntegerField(default=60)),
                ('cache_taille_max_mo', models.IntegerField(default=100)),
                ('auto_invalidation_cache', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Configuration API Kelio',
                'verbose_name_plural': 'Configurations API Kelio',
            },
        ),
        migrations.CreateModel(
            name='DemandeInterim',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('numero_demande', models.CharField(editable=False, max_length=20, unique=True)),
                ('date_debut', models.DateField(blank=True, null=True)),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('urgence', models.CharField(choices=[('NORMALE', 'Normale'), ('MOYENNE', 'Moyenne'), ('ELEVEE', 'Élevée'), ('CRITIQUE', 'Critique')], default='NORMALE', max_length=15)),
                ('description_poste', models.TextField()),
                ('instructions_particulieres', models.TextField(blank=True)),
                ('competences_indispensables', models.TextField(blank=True)),
                ('statut', models.CharField(choices=[('BROUILLON', 'Brouillon'), ('SOUMISE', 'Soumise'), ('EN_PROPOSITION', 'En recherche/proposition candidats'), ('EN_VALIDATION', 'En validation'), ('CANDIDAT_PROPOSE', 'Candidat proposé'), ('EN_COURS', 'En cours'), ('TERMINEE', 'Terminée'), ('REFUSEE', 'Refusée'), ('ANNULEE', 'Annulée')], default='BROUILLON', max_length=20)),
                ('propositions_autorisees', models.BooleanField(default=True)),
                ('nb_max_propositions_par_utilisateur', models.IntegerField(default=3)),
                ('date_limite_propositions', models.DateTimeField(blank=True, null=True)),
                ('niveau_validation_actuel', models.IntegerField(default=0)),
                ('niveaux_validation_requis', models.IntegerField(default=3, help_text='Nombre de niveaux de validation requis (3 par défaut)')),
                ('poids_scoring_automatique', models.FloatField(default=0.7)),
                ('poids_scoring_humain', models.FloatField(default=0.3)),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('date_debut_effective', models.DateField(blank=True, null=True)),
                ('date_fin_effective', models.DateField(blank=True, null=True)),
                ('evaluation_mission', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('commentaire_final', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': "Demande d'intérim",
                'verbose_name_plural': "Demandes d'intérim",
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Departement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('code', models.CharField(max_length=10, unique=True, validators=[django.core.validators.RegexValidator('^[A-Z0-9]{2,10}$', 'Code département invalide')])),
                ('kelio_department_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_last_sync', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Département',
                'verbose_name_plural': 'Départements',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='MotifAbsence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('code', models.CharField(max_length=10, unique=True, validators=[django.core.validators.RegexValidator('^[A-Z0-9]{2,10}$', 'Code motif invalide')])),
                ('kelio_absence_type_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_abbreviation', models.CharField(blank=True, max_length=5)),
                ('necessite_justificatif', models.BooleanField(default=False)),
                ('delai_prevenance_jours', models.IntegerField(default=7, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(365)])),
                ('duree_max_jours', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(365)])),
                ('categorie', models.CharField(choices=[('MALADIE', 'Maladie'), ('CONGE', 'Congé'), ('FORMATION', 'Formation'), ('PERSONNEL', 'Personnel'), ('PROFESSIONNEL', 'Professionnel')], default='PERSONNEL', max_length=20)),
                ('couleur', models.CharField(default='#007bff', max_length=7, validators=[django.core.validators.RegexValidator('^#[0-9A-Fa-f]{6}$', 'Couleur hex invalide')])),
            ],
            options={
                'verbose_name': "Motif d'absence",
                'verbose_name_plural': "Motifs d'absence",
                'ordering': ['categorie', 'nom'],
            },
        ),
        migrations.CreateModel(
            name='Poste',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('titre', models.CharField(max_length=100)),
                ('description', models.TextField()),
                ('kelio_job_key', models.IntegerField(blank=True, null=True)),
                ('niveau_etude_min', models.CharField(blank=True, max_length=50)),
                ('experience_min_mois', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(600)])),
                ('permis_requis', models.BooleanField(default=False)),
                ('categorie', models.CharField(blank=True, max_length=50)),
                ('niveau_responsabilite', models.IntegerField(choices=[(1, 'Exécution'), (2, 'Maîtrise'), (3, 'Cadre')], default=1, help_text='Niveau de responsabilité')),
                ('interim_autorise', models.BooleanField(default=True)),
                ('departement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='postes', to='mainapp.departement')),
            ],
            options={
                'verbose_name': 'Poste',
                'verbose_name_plural': 'Postes',
                'ordering': ['departement__nom', 'titre'],
            },
        ),
        migrations.CreateModel(
            name='ProfilUtilisateur',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('kelio_last_sync', models.DateTimeField(blank=True, null=True)),
                ('kelio_sync_status', models.CharField(choices=[('JAMAIS', 'Jamais synchronisé'), ('REUSSI', 'Synchronisation réussie'), ('PARTIEL', 'Synchronisation partielle'), ('ECHEC', 'Échec synchronisation')], default='JAMAIS', max_length=20)),
                ('matricule', models.CharField(max_length=20, unique=True)),
                ('type_profil', models.CharField(choices=[('UTILISATEUR', 'Utilisateur standard'), ('CHEF_EQUIPE', "Chef d'équipe"), ('RESPONSABLE', 'Responsable (N+1)'), ('DIRECTEUR', 'Directeur (N+2)'), ('RH', 'RH (Final)'), ('ADMIN', 'Administrateur (Final)')], default='UTILISATEUR', max_length=20)),
                ('statut_employe', models.CharField(choices=[('ACTIF', 'Actif'), ('CONGE', 'En congé'), ('FORMATION', 'En formation'), ('ARRET', 'Arrêt maladie'), ('SUSPENDU', 'Suspendu'), ('DEMISSION', 'Démission'), ('LICENCIE', 'Licencié')], default='ACTIF', max_length=20)),
                ('kelio_employee_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_badge_code', models.CharField(blank=True, max_length=16)),
                ('date_embauche', models.DateField(blank=True, null=True)),
                ('date_fin_contrat', models.DateField(blank=True, null=True)),
                ('departement', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employes', to='mainapp.departement')),
                ('manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='equipe', to='mainapp.profilutilisateur')),
                ('poste', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employes', to='mainapp.poste')),
            ],
            options={
                'verbose_name': 'Profil utilisateur',
                'verbose_name_plural': 'Profils utilisateurs',
                'ordering': ['matricule'],
            },
        ),
        migrations.CreateModel(
            name='PropositionCandidat',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('numero_proposition', models.CharField(editable=False, max_length=20, unique=True)),
                ('source_proposition', models.CharField(choices=[('DEMANDEUR_INITIAL', 'Demandeur initial'), ('MANAGER_DIRECT', 'Manager direct'), ('CHEF_EQUIPE', "Chef d'équipe"), ('RESPONSABLE', 'Responsable (N+1)'), ('DIRECTEUR', 'Directeur (N+2)'), ('RH', 'RH (Final)'), ('ADMIN', 'Admin (Final)'), ('SUPERUSER', 'Superutilisateur'), ('VALIDATION_ETAPE', 'Ajout lors de validation'), ('SYSTEME', 'Système automatique'), ('AUTRE', 'Autre')], max_length=20)),
                ('statut', models.CharField(choices=[('SOUMISE', 'Soumise'), ('EN_EVALUATION', 'En évaluation'), ('EVALUEE', 'Évaluée'), ('RETENUE', 'Retenue pour validation'), ('REJETEE', 'Rejetée'), ('VALIDEE', 'Validée')], default='SOUMISE', max_length=15)),
                ('niveau_validation_propose', models.IntegerField(default=1, help_text='Niveau de validation où la proposition a été faite')),
                ('justification', models.TextField(help_text='Justification obligatoire de la proposition')),
                ('competences_specifiques', models.TextField(blank=True, help_text='Compétences spécifiques du candidat pour ce poste')),
                ('experience_pertinente', models.TextField(blank=True, help_text='Expérience pertinente du candidat')),
                ('score_automatique', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_humain_ajuste', models.IntegerField(blank=True, help_text='Score ajusté par un validateur humain', null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('bonus_proposition_humaine', models.IntegerField(default=5, help_text='Bonus accordé selon le niveau hiérarchique', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('commentaire_evaluation', models.TextField(blank=True)),
                ('date_evaluation', models.DateTimeField(blank=True, null=True)),
                ('candidat_propose', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='propositions_recues', to='mainapp.profilutilisateur')),
                ('demande_interim', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='propositions_candidats', to='mainapp.demandeinterim')),
                ('evaluateur', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='propositions_evaluees', to='mainapp.profilutilisateur')),
                ('proposant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='propositions_soumises', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Proposition de candidat',
                'verbose_name_plural': 'Propositions de candidats',
                'ordering': ['-created_at'],
                'unique_together': {('demande_interim', 'candidat_propose', 'proposant')},
            },
        ),
        migrations.CreateModel(
            name='WorkflowEtape',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100)),
                ('type_etape', models.CharField(choices=[('DEMANDE', 'Création de demande'), ('PROPOSITION_CANDIDATS', 'Proposition de candidats'), ('VALIDATION_RESPONSABLE', 'Validation Responsable (N+1)'), ('VALIDATION_DIRECTEUR', 'Validation Directeur (N+2)'), ('VALIDATION_RH_ADMIN', 'Validation RH/Admin (Final)'), ('NOTIFICATION_CANDIDAT', 'Notification candidat'), ('ACCEPTATION_CANDIDAT', 'Acceptation candidat'), ('FINALISATION', 'Finalisation')], max_length=30)),
                ('ordre', models.IntegerField()),
                ('obligatoire', models.BooleanField(default=True)),
                ('delai_max_heures', models.IntegerField(blank=True, null=True)),
                ('condition_urgence', models.CharField(choices=[('TOUTES', 'Toutes'), ('NORMALE', 'Normale'), ('ELEVEE', 'Élevée'), ('CRITIQUE', 'Critique')], default='TOUTES', max_length=15)),
                ('permet_propositions_humaines', models.BooleanField(default=True)),
                ('permet_ajout_nouveaux_candidats', models.BooleanField(default=True)),
                ('actif', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Étape de workflow',
                'verbose_name_plural': 'Étapes de workflow',
                'ordering': ['ordre'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowDemande',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('date_derniere_action', models.DateTimeField(auto_now=True)),
                ('historique_actions', models.JSONField(default=list)),
                ('nb_propositions_recues', models.IntegerField(default=0)),
                ('nb_candidats_evalues', models.IntegerField(default=0)),
                ('nb_niveaux_validation_passes', models.IntegerField(default=0)),
                ('demande', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='workflow', to='mainapp.demandeinterim')),
                ('etape_actuelle', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='workflows_en_cours', to='mainapp.workflowetape')),
            ],
            options={
                'verbose_name': 'Workflow de demande',
                'verbose_name_plural': 'Workflows de demandes',
            },
        ),
        migrations.CreateModel(
            name='ValidationDemande',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('type_validation', models.CharField(choices=[('RESPONSABLE', 'Validation Responsable (N+1)'), ('DIRECTEUR', 'Validation Directeur (N+2)'), ('RH', 'Validation RH (Final)'), ('ADMIN', 'Validation Admin (Final)'), ('SUPERUSER', 'Validation Superutilisateur'), ('URGENCE', "Validation d'urgence")], max_length=20)),
                ('niveau_validation', models.IntegerField(default=1)),
                ('decision', models.CharField(choices=[('APPROUVE', 'Approuvé'), ('APPROUVE_AVEC_MODIF', 'Approuvé avec modifications'), ('REFUSE', 'Refusé'), ('REPORTE', 'Reporté'), ('CANDIDAT_AJOUTE', 'Candidat ajouté')], max_length=25)),
                ('commentaire', models.TextField(blank=True)),
                ('date_demande_validation', models.DateTimeField(auto_now_add=True)),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('candidats_retenus', models.JSONField(default=list, help_text='Liste des candidats retenus avec leurs scores')),
                ('candidats_rejetes', models.JSONField(default=list, help_text='Liste des candidats rejetés avec raisons')),
                ('justification_nouveau_candidat', models.TextField(blank=True)),
                ('demande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='validations', to='mainapp.demandeinterim')),
                ('nouveau_candidat_propose', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='propositions_lors_validation', to='mainapp.profilutilisateur')),
                ('validateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='validations_effectuees', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Validation de demande',
                'verbose_name_plural': 'Validations de demandes',
                'ordering': ['-date_demande_validation'],
            },
        ),
        migrations.CreateModel(
            name='Site',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(max_length=100)),
                ('adresse', models.TextField()),
                ('ville', models.CharField(max_length=50)),
                ('code_postal', models.CharField(max_length=10, validators=[django.core.validators.RegexValidator('^\\d{5}$', 'Code postal invalide')])),
                ('pays', models.CharField(default="Côte d'Ivoire", max_length=50)),
                ('telephone', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('kelio_site_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_last_sync', models.DateTimeField(blank=True, null=True)),
                ('responsable', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='sites_geres', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Site',
                'verbose_name_plural': 'Sites',
                'ordering': ['ville', 'nom'],
            },
        ),
        migrations.CreateModel(
            name='ProfilUtilisateurKelio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('kelio_employee_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('kelio_badge_code', models.CharField(blank=True, max_length=16)),
                ('telephone_kelio', models.CharField(blank=True, max_length=20)),
                ('email_kelio', models.EmailField(blank=True, max_length=254)),
                ('date_embauche_kelio', models.DateField(blank=True, null=True)),
                ('type_contrat_kelio', models.CharField(blank=True, max_length=100)),
                ('temps_travail_kelio', models.FloatField(default=1.0)),
                ('code_personnel', models.CharField(blank=True, max_length=20)),
                ('profil_acces', models.CharField(blank=True, max_length=100)),
                ('horaires_specifiques_autorises', models.BooleanField(default=False)),
                ('profil', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='kelio_data', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Données Kelio utilisateur',
                'verbose_name_plural': 'Données Kelio utilisateurs',
            },
        ),
        migrations.CreateModel(
            name='ProfilUtilisateurExtended',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('telephone', models.CharField(blank=True, max_length=20)),
                ('telephone_portable', models.CharField(blank=True, max_length=20)),
                ('date_embauche', models.DateField(blank=True, null=True)),
                ('date_fin_contrat', models.DateField(blank=True, null=True)),
                ('type_contrat', models.CharField(blank=True, max_length=100)),
                ('temps_travail', models.FloatField(default=1.0, validators=[django.core.validators.MinValueValidator(0.1), django.core.validators.MaxValueValidator(1.0)])),
                ('prochaine_visite_medicale', models.DateField(blank=True, null=True)),
                ('permis_conduire', models.CharField(blank=True, max_length=50)),
                ('situation_handicap', models.BooleanField(default=False)),
                ('coefficient', models.CharField(blank=True, max_length=100)),
                ('niveau_classification', models.CharField(blank=True, max_length=100)),
                ('statut_professionnel', models.CharField(blank=True, max_length=100)),
                ('disponible_interim', models.BooleanField(default=True)),
                ('rayon_deplacement_km', models.IntegerField(default=50, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(500)])),
                ('profil', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='extended_data', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Données étendues utilisateur',
                'verbose_name_plural': 'Données étendues utilisateurs',
            },
        ),
        migrations.AddField(
            model_name='profilutilisateur',
            name='site',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employes', to='mainapp.site'),
        ),
        migrations.AddField(
            model_name='profilutilisateur',
            name='user',
            field=models.OneToOneField(blank=True, help_text='Utilisateur Django associé', null=True, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='poste',
            name='site',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='postes', to='mainapp.site'),
        ),
        migrations.CreateModel(
            name='FormationUtilisateur',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('kelio_formation_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('titre', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('type_formation', models.CharField(blank=True, max_length=100)),
                ('organisme', models.CharField(blank=True, max_length=200)),
                ('date_debut', models.DateField(blank=True, null=True)),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('duree_jours', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(365)])),
                ('certifiante', models.BooleanField(default=False)),
                ('diplome_obtenu', models.BooleanField(default=True)),
                ('source_donnee', models.CharField(choices=[('LOCAL', 'Locale'), ('KELIO', 'Kelio')], default='LOCAL', max_length=10)),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='formations', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Formation utilisateur',
                'verbose_name_plural': 'Formations utilisateurs',
                'ordering': ['-date_fin', 'titre'],
            },
        ),
        migrations.CreateModel(
            name='DisponibiliteUtilisateur',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('type_disponibilite', models.CharField(choices=[('DISPONIBLE', 'Disponible'), ('INDISPONIBLE', 'Indisponible'), ('EN_MISSION', 'En mission'), ('CONGE', 'En congé'), ('FORMATION', 'En formation'), ('AUTRE', 'Autre')], max_length=20)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField()),
                ('commentaire', models.TextField(blank=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='disponibilites_saisies', to='mainapp.profilutilisateur')),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='disponibilites', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Disponibilité utilisateur',
                'verbose_name_plural': 'Disponibilités utilisateurs',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.AddField(
            model_name='departement',
            name='manager',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='departements_geres', to='mainapp.profilutilisateur'),
        ),
        migrations.AddField(
            model_name='demandeinterim',
            name='candidat_selectionne',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='selections_interim', to='mainapp.profilutilisateur'),
        ),
        migrations.AddField(
            model_name='demandeinterim',
            name='demandeur',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='demandes_soumises', to='mainapp.profilutilisateur'),
        ),
        migrations.AddField(
            model_name='demandeinterim',
            name='motif_absence',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='demandes', to='mainapp.motifabsence'),
        ),
        migrations.AddField(
            model_name='demandeinterim',
            name='personne_remplacee',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='remplacements', to='mainapp.profilutilisateur'),
        ),
        migrations.AddField(
            model_name='demandeinterim',
            name='poste',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='demandes_interim', to='mainapp.poste'),
        ),
        migrations.CreateModel(
            name='AbsenceUtilisateur',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('kelio_absence_file_key', models.IntegerField(blank=True, null=True, unique=True)),
                ('type_absence', models.CharField(max_length=100)),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField()),
                ('duree_jours', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(365)])),
                ('commentaire', models.TextField(blank=True)),
                ('source_donnee', models.CharField(choices=[('LOCAL', 'Locale'), ('KELIO', 'Kelio')], default='KELIO', max_length=10)),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='absences', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Absence utilisateur',
                'verbose_name_plural': 'Absences utilisateurs',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ScoreDetailCandidat',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('score_similarite_poste', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_competences', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_disponibilite', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_proximite', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_anciennete', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('score_experience', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('bonus_proposition_humaine', models.IntegerField(default=0)),
                ('bonus_experience_similaire', models.IntegerField(default=0)),
                ('bonus_recommandation', models.IntegerField(default=0)),
                ('bonus_hierarchique', models.IntegerField(default=0, help_text='Bonus selon le niveau hiérarchique du proposant')),
                ('penalite_indisponibilite', models.IntegerField(default=0)),
                ('score_total', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('calcule_par', models.CharField(choices=[('AUTOMATIQUE', 'Automatique'), ('HUMAIN', 'Humain')], default='AUTOMATIQUE', max_length=20)),
                ('candidat', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scores_details', to='mainapp.profilutilisateur')),
                ('demande_interim', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scores_candidats', to='mainapp.demandeinterim')),
                ('proposition_humaine', models.ForeignKey(blank=True, help_text="Référence si c'est une proposition humaine", null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='score_candidat', to='mainapp.propositioncandidat')),
            ],
            options={
                'verbose_name': 'Score détaillé candidat',
                'verbose_name_plural': 'Scores détaillés candidats',
                'ordering': ['-score_total'],
                'unique_together': {('candidat', 'demande_interim')},
            },
        ),
        migrations.CreateModel(
            name='ReponseCandidatInterim',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('reponse', models.CharField(choices=[('ACCEPTE', 'Accepté'), ('REFUSE', 'Refusé'), ('EN_ATTENTE', 'En attente de réponse'), ('EXPIRE', 'Expiré')], default='EN_ATTENTE', max_length=15)),
                ('motif_refus', models.CharField(blank=True, choices=[('INDISPONIBLE', 'Indisponible'), ('COMPETENCES', 'Compétences insuffisantes'), ('DISTANCE', 'Trop éloigné'), ('REMUNERATION', 'Rémunération insuffisante'), ('PERSONNEL', 'Raisons personnelles'), ('CONFLIT_HORAIRES', "Conflit d'horaires"), ('AUTRE', 'Autre')], max_length=20, null=True)),
                ('commentaire_refus', models.TextField(blank=True)),
                ('date_proposition', models.DateTimeField(auto_now_add=True)),
                ('date_reponse', models.DateTimeField(blank=True, null=True)),
                ('date_limite_reponse', models.DateTimeField()),
                ('salaire_propose', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('avantages_proposes', models.TextField(blank=True)),
                ('nb_rappels_envoyes', models.IntegerField(default=0)),
                ('derniere_date_rappel', models.DateTimeField(blank=True, null=True)),
                ('candidat', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reponses_interim', to='mainapp.profilutilisateur')),
                ('demande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reponses_candidats', to='mainapp.demandeinterim')),
            ],
            options={
                'verbose_name': 'Réponse candidat intérim',
                'verbose_name_plural': 'Réponses candidats intérim',
                'ordering': ['-date_proposition'],
                'unique_together': {('demande', 'candidat')},
            },
        ),
        migrations.CreateModel(
            name='NotificationInterim',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('type_notification', models.CharField(choices=[('NOUVELLE_DEMANDE', "Nouvelle demande d'intérim"), ('DEMANDE_A_VALIDER', 'Demande à valider'), ('PROPOSITION_CANDIDAT', 'Nouvelle proposition de candidat'), ('CANDIDAT_PROPOSE_VALIDATION', 'Candidat proposé pour validation'), ('VALIDATION_EFFECTUEE', 'Validation effectuée'), ('CANDIDAT_SELECTIONNE', 'Candidat sélectionné'), ('CANDIDAT_NOTIFIE', 'Candidat notifié'), ('CANDIDAT_ACCEPTE', 'Candidat a accepté'), ('CANDIDAT_REFUSE', 'Candidat a refusé'), ('MISSION_DEMARREE', 'Mission démarrée'), ('MISSION_TERMINEE', 'Mission terminée'), ('RAPPEL_VALIDATION', 'Rappel de validation'), ('RETARD_WORKFLOW', 'Retard dans le workflow')], max_length=30)),
                ('urgence', models.CharField(choices=[('BASSE', 'Basse'), ('NORMALE', 'Normale'), ('HAUTE', 'Haute'), ('CRITIQUE', 'Critique')], default='NORMALE', max_length=15)),
                ('statut', models.CharField(choices=[('NON_LUE', 'Non lue'), ('LUE', 'Lue'), ('TRAITEE', 'Traitée'), ('ARCHIVEE', 'Archivée')], default='NON_LUE', max_length=15)),
                ('titre', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('url_action_principale', models.URLField(blank=True)),
                ('url_action_secondaire', models.URLField(blank=True)),
                ('texte_action_principale', models.CharField(blank=True, max_length=100)),
                ('texte_action_secondaire', models.CharField(blank=True, max_length=100)),
                ('date_lecture', models.DateTimeField(blank=True, null=True)),
                ('date_traitement', models.DateTimeField(blank=True, null=True)),
                ('date_expiration', models.DateTimeField(blank=True, null=True)),
                ('nb_rappels_envoyes', models.IntegerField(default=0)),
                ('prochaine_date_rappel', models.DateTimeField(blank=True, null=True)),
                ('metadata', models.JSONField(default=dict, help_text='Métadonnées supplémentaires pour les notifications')),
                ('demande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications', to='mainapp.demandeinterim')),
                ('destinataire', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications_recues', to='mainapp.profilutilisateur')),
                ('expediteur', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notifications_envoyees', to='mainapp.profilutilisateur')),
                ('proposition_liee', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notifications', to='mainapp.propositioncandidat')),
                ('validation_liee', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notifications', to='mainapp.validationdemande')),
            ],
            options={
                'verbose_name': 'Notification intérim',
                'verbose_name_plural': 'Notifications intérim',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['destinataire', 'statut'], name='mainapp_not_destina_36f618_idx'), models.Index(fields=['demande', 'type_notification'], name='mainapp_not_demande_1bb2f4_idx')],
            },
        ),
        migrations.CreateModel(
            name='HistoriqueAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('action', models.CharField(choices=[('CREATION_DEMANDE', 'Création demande'), ('MODIFICATION_DEMANDE', 'Modification demande'), ('PROPOSITION_CANDIDAT', 'Proposition candidat'), ('EVALUATION_CANDIDAT', 'Évaluation candidat'), ('VALIDATION_RESPONSABLE', 'Validation Responsable (N+1)'), ('VALIDATION_DIRECTEUR', 'Validation Directeur (N+2)'), ('VALIDATION_RH', 'Validation RH (Final)'), ('VALIDATION_ADMIN', 'Validation Admin (Final)'), ('VALIDATION_SUPERUSER', 'Validation Superutilisateur'), ('SELECTION_CANDIDAT', 'Sélection candidat'), ('NOTIFICATION_CANDIDAT', 'Notification candidat'), ('REPONSE_CANDIDAT', 'Réponse candidat'), ('DEBUT_MISSION', 'Début mission'), ('FIN_MISSION', 'Fin mission'), ('ANNULATION', 'Annulation'), ('COMMENTAIRE', 'Ajout commentaire')], max_length=25)),
                ('description', models.TextField()),
                ('donnees_avant', models.JSONField(blank=True, null=True)),
                ('donnees_apres', models.JSONField(blank=True, null=True)),
                ('adresse_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.CharField(blank=True, max_length=500)),
                ('niveau_validation', models.IntegerField(blank=True, null=True)),
                ('niveau_hierarchique', models.CharField(blank=True, max_length=20)),
                ('is_superuser', models.BooleanField(default=False)),
                ('demande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historique_actions', to='mainapp.demandeinterim')),
                ('proposition', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='historique', to='mainapp.propositioncandidat')),
                ('utilisateur', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='actions_historique', to='mainapp.profilutilisateur')),
                ('validation', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='historique', to='mainapp.validationdemande')),
            ],
            options={
                'verbose_name': 'Historique action',
                'verbose_name_plural': 'Historiques actions',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['demande', 'action'], name='mainapp_his_demande_38fe71_idx'), models.Index(fields=['utilisateur', 'created_at'], name='mainapp_his_utilisa_c804a6_idx'), models.Index(fields=['niveau_hierarchique', 'is_superuser'], name='mainapp_his_niveau__4a1610_idx')],
            },
        ),
        migrations.CreateModel(
            name='ConfigurationScoring',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('actif', models.BooleanField(default=True)),
                ('nom', models.CharField(help_text="Nom de la configuration (ex: 'Défaut', 'Technique', 'Commercial')", max_length=100, unique=True)),
                ('description', models.TextField(blank=True, help_text='Description de cette configuration de scoring')),
                ('poids_similarite_poste', models.FloatField(default=0.25, help_text='Poids pour la similarité de poste (0.0 à 1.0)', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('poids_competences', models.FloatField(default=0.25, help_text='Poids pour les compétences (0.0 à 1.0)', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('poids_experience', models.FloatField(default=0.2, help_text="Poids pour l'expérience (0.0 à 1.0)", validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('poids_disponibilite', models.FloatField(default=0.15, help_text='Poids pour la disponibilité (0.0 à 1.0)', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('poids_proximite', models.FloatField(default=0.1, help_text='Poids pour la proximité géographique (0.0 à 1.0)', validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('poids_anciennete', models.FloatField(default=0.05, help_text="Poids pour l'ancienneté (0.0 à 1.0)", validators=[django.core.validators.MinValueValidator(0.0), django.core.validators.MaxValueValidator(1.0)])),
                ('bonus_proposition_humaine', models.IntegerField(default=5, help_text='Bonus de base pour proposition humaine (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_experience_similaire', models.IntegerField(default=8, help_text='Bonus pour expérience similaire (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_recommandation', models.IntegerField(default=10, help_text='Bonus pour qualité de recommandation (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_manager_direct', models.IntegerField(default=12, help_text='Bonus pour proposition par manager direct (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_chef_equipe', models.IntegerField(default=8, help_text="Bonus pour proposition par chef d'équipe (0-50 points)", validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_responsable', models.IntegerField(default=15, help_text='Bonus pour proposition par RESPONSABLE (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_directeur', models.IntegerField(default=18, help_text='Bonus pour proposition par DIRECTEUR (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_rh', models.IntegerField(default=20, help_text='Bonus pour proposition par RH (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_admin', models.IntegerField(default=20, help_text='Bonus pour proposition par ADMIN (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('bonus_superuser', models.IntegerField(default=0, help_text='Bonus pour proposition par SUPERUTILISATEUR (0-50 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(50)])),
                ('penalite_indisponibilite_partielle', models.IntegerField(default=15, help_text='Pénalité pour indisponibilité partielle (0-100 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('penalite_indisponibilite_totale', models.IntegerField(default=50, help_text='Pénalité pour indisponibilité totale (0-100 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('penalite_distance_excessive', models.IntegerField(default=10, help_text='Pénalité pour distance excessive (0-100 points)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('configuration_par_defaut', models.BooleanField(default=False, help_text='Configuration utilisée par défaut')),
                ('pour_types_urgence', models.CharField(blank=True, help_text="Types d'urgence pour cette config (ex: 'NORMALE,ELEVEE')", max_length=100)),
                ('last_used', models.DateTimeField(blank=True, null=True)),
                ('nb_utilisations', models.IntegerField(default=0)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='configurations_scoring_creees', to='mainapp.profilutilisateur')),
                ('pour_departements', models.ManyToManyField(blank=True, help_text='Départements autorisés à utiliser cette configuration', to='mainapp.departement')),
            ],
            options={
                'verbose_name': 'Configuration de scoring',
                'verbose_name_plural': 'Configurations de scoring',
                'ordering': ['-configuration_par_defaut', 'nom'],
                'indexes': [models.Index(fields=['actif', 'configuration_par_defaut'], name='mainapp_con_actif_ec14d4_idx')],
            },
        ),
        migrations.CreateModel(
            name='CompetenceUtilisateur',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('niveau_maitrise', models.IntegerField(choices=[(1, 'Débutant'), (2, 'Intermédiaire'), (3, 'Confirmé'), (4, 'Expert')], validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(4)])),
                ('source_donnee', models.CharField(choices=[('LOCAL', 'Saisie locale'), ('KELIO', 'Importé Kelio'), ('MIXTE', 'Mixte')], default='LOCAL', max_length=10)),
                ('kelio_skill_assignment_key', models.IntegerField(blank=True, null=True)),
                ('kelio_level', models.CharField(blank=True, max_length=50)),
                ('date_acquisition', models.DateField(blank=True, null=True)),
                ('date_evaluation', models.DateField(blank=True, null=True)),
                ('certifie', models.BooleanField(default=False)),
                ('date_certification', models.DateField(blank=True, null=True)),
                ('organisme_certificateur', models.CharField(blank=True, max_length=100)),
                ('commentaire', models.TextField(blank=True)),
                ('competence', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='competences_utilisateurs', to='mainapp.competence')),
                ('evaluateur', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='competences_evaluees', to='mainapp.profilutilisateur')),
                ('utilisateur', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='competences', to='mainapp.profilutilisateur')),
            ],
            options={
                'verbose_name': 'Compétence utilisateur',
                'verbose_name_plural': 'Compétences utilisateurs',
                'ordering': ['-niveau_maitrise', 'competence__nom'],
                'unique_together': {('utilisateur', 'competence')},
            },
        ),
        migrations.CreateModel(
            name='CacheApiKelio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cle_cache', models.CharField(db_index=True, max_length=255)),
                ('service_name', models.CharField(db_index=True, max_length=100)),
                ('parametres_requete', models.JSONField()),
                ('donnees', models.JSONField()),
                ('date_expiration', models.DateTimeField(db_index=True)),
                ('nb_acces', models.IntegerField(default=0)),
                ('taille_donnees', models.IntegerField(default=0)),
                ('configuration', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='caches', to='mainapp.configurationapikelio')),
            ],
            options={
                'verbose_name': 'Cache API Kelio',
                'verbose_name_plural': 'Caches API Kelio',
                'ordering': ['-created_at'],
                'unique_together': {('configuration', 'cle_cache')},
            },
        ),
    ]
